<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pocket Text Lab ‚Äì Python NLP via Pyodide</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Pyodide (stable, maintained) -->
    <script>
        window.loadPyodidePromise = loadPyodide({
            indexURL: "https://cdn.jsdelivr.net/pyodide/v0.26.0/full/"
        });
    </script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.26.0/full/pyodide.js"></script>

    <style>
      body {
        background: #0f172a;
      }

      /* Smooth fade-in */
      body.loaded {
        opacity: 1;
        transition: opacity 0.4s ease-out;
      }

      body {
        opacity: 0;
      }
    </style>
</head>

<body class="text-slate-100 min-h-screen">
    <div class="max-w-5xl mx-auto px-4 py-10">

        <h1 class="text-4xl font-bold tracking-tight mb-2">Pocket Text Lab</h1>
        <p class="text-slate-300 max-w-2xl mb-8">
            A tiny NLP playground using <span class="font-semibold">Python via Pyodide</span>.
            Paste any text to explore basic stats, sentiment, and top keywords ‚Äì directly in your browser.
        </p>

        <div class="grid md:grid-cols-2 gap-8">

            <!-- INPUT CARD -->
            <section class="bg-slate-900/70 border border-slate-800 rounded-xl p-6 shadow-lg">
                <div class="flex justify-between mb-3">
                    <h2 class="font-semibold">Your Text</h2>
                    <div class="flex gap-2">
                        <button id="sample" class="text-xs px-2 py-1 border border-slate-500 rounded hover:border-sky-400">Load sample</button>
                        <button id="clear" class="text-xs px-2 py-1 border border-slate-500 rounded hover:border-rose-400">Clear</button>
                    </div>
                </div>

                <textarea id="input" class="w-full h-56 bg-slate-950/80 border border-slate-800 rounded px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-sky-500 resize-none"></textarea>

                <button id="analyze" class="w-full mt-4 bg-sky-500 hover:bg-sky-400 text-slate-900 font-semibold py-2 rounded">
                    Analyze with Python üêç
                </button>
            </section>

            <!-- OUTPUT CARD -->
            <section class="bg-slate-900/70 border border-slate-800 rounded-xl p-6 shadow-lg">
                <div class="flex justify-between mb-4">
                    <h2 class="font-semibold">Insights</h2>
                    <span id="status" class="text-xs text-slate-400">Waiting‚Ä¶</span>
                </div>

                <div class="grid grid-cols-2 gap-3 text-sm mb-6">
                    <div class="bg-slate-950/60 border border-slate-800 rounded px-3 py-2">
                        <p class="text-[11px] text-slate-400 uppercase">Words</p>
                        <p id="words" class="text-xl font-semibold">0</p>
                    </div>
                    <div class="bg-slate-950/60 border border-slate-800 rounded px-3 py-2">
                        <p class="text-[11px] text-slate-400 uppercase">Sentences</p>
                        <p id="sentences" class="text-xl font-semibold">0</p>
                    </div>
                    <div class="bg-slate-950/60 border border-slate-800 rounded px-3 py-2">
                        <p class="text-[11px] text-slate-400 uppercase">Reading Time</p>
                        <p id="reading" class="text-xl font-semibold">0 sec</p>
                    </div>
                    <div class="bg-slate-950/60 border border-slate-800 rounded px-3 py-2">
                        <p class="text-[11px] text-slate-400 uppercase">Unique Words</p>
                        <p id="unique" class="text-xl font-semibold">0</p>
                    </div>
                </div>

                <h3 class="text-xs text-slate-300 uppercase mb-1">Sentiment</h3>
                <p id="sentiment" class="text-sm">‚Äî</p>
                <p id="sentiment-score" class="text-xs text-slate-400 mb-4">Score: 0</p>

                <h3 class="text-xs text-slate-300 uppercase mb-1">Top Keywords</h3>
                <div id="keywords" class="flex flex-wrap gap-1 text-xs"></div>
            </section>

        </div>
    </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    document.body.classList.add("loaded");
});

const SAMPLE_TEXT = `
Pocket Text Lab is a tiny browser-based playground for experimenting with text.
It was built to showcase how Python can run directly in the browser using Pyodide.
Paste any content you like: product descriptions, marketing copy, emails, or blog posts.
`;

document.getElementById("sample").onclick = () => {
    document.getElementById("input").value = SAMPLE_TEXT.trim();
};
document.getElementById("clear").onclick = () => {
    document.getElementById("input").value = "";
};

// PYTHON NLP LOGIC ‚Äî executed inside Pyodide
async function analyze() {
    const text = document.getElementById("input").value.trim();
    const status = document.getElementById("status");

    if (!text) {
        status.textContent = "Waiting‚Ä¶";
        return;
    }

    status.textContent = "Running Python‚Ä¶";

    const pyodide = await window.loadPyodidePromise;

    const pythonCode = `
from collections import Counter
import math
import re

raw = """${text.replace(/`/g, "\\`")}"""

def tokenize(t):
    return [w for w in re.split(r"[^a-zA-Z]+", t.lower()) if w]

words = tokenize(raw)
word_count = len(words)
unique_count = len(set(words))

sentences = [s.strip() for s in re.split(r"[.!?]+", raw) if s.strip()]
sentence_count = len(sentences)

# reading time
minutes = word_count / 200
seconds = math.ceil(minutes * 60)

positive = {"good","great","excellent","love","amazing","nice","clean","simple"}
negative = {"bad","terrible","awful","hate","ugly","slow"}

pos = sum(w in positive for w in words)
neg = sum(w in negative for w in words)
score = pos - neg

filtered = [w for w in words if w not in {"the","and","to","a","in","of"}]
freq = Counter(filtered).most_common(10)

{
 "word_count": word_count,
 "unique": unique_count,
 "sentences": sentence_count,
 "seconds": seconds,
 "sentiment": score,
 "keywords": freq
}
`;

    const result = await pyodide.runPythonAsync(pythonCode);

    document.getElementById("words").textContent = result.word_count;
    document.getElementById("unique").textContent = result.unique;
    document.getElementById("sentences").textContent = result.sentences;
    document.getElementById("reading").textContent = result.seconds + " sec";

    document.getElementById("sentiment").textContent =
        result.sentiment > 0 ? "Positive" :
        result.sentiment < 0 ? "Negative" : "Neutral";

    document.getElementById("sentiment-score").textContent =
        "Score: " + result.sentiment;

    const kw = document.getElementById("keywords");
    kw.innerHTML = "";
    result.keywords.forEach(pair => {
        const el = document.createElement("span");
        el.className = "px-2 py-0.5 border border-slate-700 rounded-full";
        el.textContent = `${pair[0]} (${pair[1]})`;
        kw.appendChild(el);
    });

    status.textContent = "Done ‚úì";
}

document.getElementById("analyze").onclick = analyze;
</script>

</body>
</html>
